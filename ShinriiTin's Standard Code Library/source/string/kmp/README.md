define fail[x] as max i s.t. S[$1\cdots i$]=S[$x-i+1\cdots x$]

time complexity: $O(n)$

space complexity: $O(n)$
